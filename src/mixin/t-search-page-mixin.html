<link rel="import" href="./t-page-mixin.html">

<script>
(function () {
    'use strict';

    /* @polymerMixin */

    var TSearchPageMixin = function TSearchPageMixin(superClass) {

        return function (_TPageMixin) {
            babelHelpers.inherits(_class, _TPageMixin);

            function _class() {
                babelHelpers.classCallCheck(this, _class);
                return babelHelpers.possibleConstructorReturn(this, (_class.__proto__ || Object.getPrototypeOf(_class)).call(this));
            }

            babelHelpers.createClass(_class, [{
                key: 'onSearch',

                /*
                 * <p>Event handler method called when `search` event is fired</p>
                 */
                value: function onSearch(e) {
                    this._showProgress(true);
                    this.searchRequest = e.detail;
                    this._saveInSessionStore(this._sessionKeys.searchCriteria, e.detail);
                }

                /*
                 * <p>Event handler method called when `search-api-success` event is fired</p>
                 */

            }, {
                key: 'onSearchSuccess',
                value: function onSearchSuccess(e) {
                    if (!e.detail) {
                        this.$.notify.active = true;
                        this.$.notify.message = event.detail.code + ' - ' + event.detail.message;
                        console.error('something blew up!');
                        return;
                    }
                    //setting the search Id global for all pages in app
                    this.searchId = e.detail.searchId;

                    this.queryParams = {
                        searchId: this.searchId
                    };

                    this.fire('search-page-success', {
                        product: this.productName,
                        data: this.searchedData,
                        searchId: e.detail.searchId
                    });
                }

                /*
                 * <p>Event handler method called when `search-api-error` event is fired</p>
                 */

            }, {
                key: 'onSearchError',
                value: function onSearchError(e) {
                    this._showProgress(false);
                    this.$.notify.active = true;
                    this.$.notify.message = event.detail.code + ' - ' + event.detail.message;
                    //console.error(e.detail);
                    this.fire('search-error', e.detail);
                }
            }], [{
                key: 'properties',
                get: function get() {
                    return {
                        searchId: {
                            type: String,
                            notify: true
                        },
                        // Searched Data of the component.
                        searchedData: {
                            type: Object,
                            notify: true
                        }
                    };
                }
            }]);
            return _class;
        }(TPageMixin(superClass));
    };
    window.TSearchPageMixin = TSearchPageMixin;
})();</script>