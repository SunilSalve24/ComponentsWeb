<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../nxt-shared-styles.html">
<link rel="import" href="../../bower_components/t-mystique-auth/t-mystique-auth.html">
<link rel="import" href="../../bower_components/t-deals/t-deals.html">
<link rel="import" href="../../bower_components/t-hotel-search/t-hotel-search.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../page-helper/t-hotel-search-api.html">
<link rel="import" href="../mixin/t-search-page-mixin.html">

<dom-module id="home-page">
  <template>
    <style include="shared-styles">
      .search-container {
        height: calc(100vh - 64px);
        padding: 0 16px;
        background-image: url('/images/background.jpg');
        background-size: cover;
        color: white;
      }

      .search-heading {
        font-size: 3em;
        font-weight: bolder;
      }

      @media (max-width: 950px) {
        .search-heading {
          font-size: 2em;
        }
        t-hotel-search {
          padding-left: 15px;
        }
      }

      @media (max-width: 650px) {
        .search-heading {
          font-size: 25px;
        }
      }

      @media (max-width: 500px) {
        .search-heading {
          font-size: 15px;
        }
      }
    </style>


    <t-mystique-auth name="mystique" url="https://demo.travelnxt.com/api/authentication/authenticate/context" token-response="{{tokenResponse}}"
      auto>
    </t-mystique-auth>

    <div class="search-container">
      <div class="search-heading">
        THE EASIEST WAY TO FIND YOUR HOTEL
      </div>
      <t-hotel-search option=[[searchOptions]] resources=[[searchResources]] data-Url="https://demo.travelnxt.com/api/content/autosuggest/"
        token-response="{{tokenResponse}}" on-do-search="_onHotelSearchTrigger">
      </t-hotel-search>
    </div>

    <div classs="homepage-deal-container">
      <t-deals heading="EXPLORE POPULAR DESTINATIONS" data="[[dealData]]"></t-deals>
    </div>
    <t-hotel-search-api api-base-url="[[apiBaseUrl]]" request="[[searchRequest]]"></t-hotel-search-api>


    <!-- <iron-ajax id="ajaxHotelSearch" url="[[apiBaseUrl]]/api/hotel/search/init" handle-as="json" last-response="{{searchRS}}" on-response="_onSearchRespone"></iron-ajax> -->

  </template>

  <script>
    class HomePage extends TSearchPageMixin(Polymer.Element) {
      static get is() { return 'home-page';}
      
      static get properties() {
        return {
          dealData: {
            type: Array,
            value: function () {
              return window.dealData;
            }
          },
          apiBaseUrl: {
            type: String,
            value: ''
          },
          _searchRequest: {
            type: Object
          }
        }
      }
      //This method will get executed when user click on search button
      _onHotelSearchTrigger(e) {
        this.searchRequest = e.detail;
        this.set("pageLoader", true);
      }
    }

    window.customElements.define(HomePage.is, HomePage);
  </script>
</dom-module>